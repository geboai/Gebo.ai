<!--
/**
 * This Source Code is subject to the terms of the 
 * Gebo.ai community version Mozilla Public License Version 2.0 (MPL-2.0) â€” With Data Protection Clauses
 * If a copy of the LICENCE was not distributed with this file, You can obtain one at 
 * https://gebo.ai/gebo-ai-community-version-mozilla-public-license-version-2-0-mpl-2-0-with-data-protection-clauses/  
 * and https://mozilla.org/MPL/2.0/.
 * Copyright (c) 2025+ Gebo.ai 
 */
 -->

<p-blockUI [target]="secretEdit" [blocked]="loading">
    <i class="pi pi-lock" style="font-size: 3rem"></i>
</p-blockUI>
<p-panel id="MainPanel" gebo-ai-label #secretEdit header="Creating identity">
    <div class="geboDialogContent">
        <p-messages [(value)]="userMessages" [enableService]="false" [closable]="false" />
        <div class="grid" [formGroup]="formGroup">
            <div class="col-4">
                <gebo-ai-field id="description" label="Description" help="Enter identity description." [required]="true">
                    <input pInputText id="description" formControlName="description" maxlength="120" [required]="true" gebo-ai-field-element />
                </gebo-ai-field>
            </div>
            <div class="col-4">
                <gebo-ai-field id="code" label="Unique Code" help="Automatically generated unique code of the identity.">
                    <input pInputText id="code" formControlName="code" readonly="true" gebo-ai-field-element />
                </gebo-ai-field>
            </div>
            <div class="col-4">
                <gebo-ai-field id="secretType" label="Identity type" help="Select the identity type to create for the remote system" [required]="true">
                    <geboai-editable-listbox-component formControlName="secretType" placeholder="Select the identity type" [required]="true" [data]="choosableTypes" gebo-ai-field-element>
                    </geboai-editable-listbox-component>
                </gebo-ai-field>
            </div>

            <div class="col-12 grid" *ngIf="actualSecretType==='USERNAME_PASSWORD'" formGroupName="usernamePasswordContent">
                <div class="col-6">
                    <gebo-ai-field id="username" label="User name" help="Enter the user name.">
                        <input pInputText id="username" formControlName="username" maxlength="80" gebo-ai-field-element />
                    </gebo-ai-field>
                </div>
                <div class="col-6">
                    <gebo-ai-field id="password" label="Password" help="Enter the password.">
                        <p-password id="password" formControlName="password" maxlength="80" gebo-ai-field-element />
                    </gebo-ai-field>
                </div>
            </div>
            <div class="col-12 grid" *ngIf="actualSecretType==='TOKEN'" formGroupName="tokenContent">
                <div class="col-12">
                    <gebo-ai-field id="user" label="User" help="Enter the user indicated by the token.">
                        <input pInputText id="user" formControlName="user" gebo-ai-field-element />
                    </gebo-ai-field>
                </div>
                <div class="col-12">
                    <gebo-ai-field id="token" label="Token" help="Enter the token.">
                        <input pInputText id="token" formControlName="token" gebo-ai-field-element />
                    </gebo-ai-field>
                </div>
            </div>
            <div class="col-12 grid" *ngIf="actualSecretType==='SSH_KEY'" formGroupName="sshContent">
                <div class="col-6">
                    <gebo-ai-field id="email" label="E-mail/User name" help="Enter the e-mail or user name associated to the ssh key.">
                        <input pInputText id="email" formControlName="email" gebo-ai-field-element />
                    </gebo-ai-field>
                </div>
                <div class="col-6">
                    <gebo-ai-field id="passphrase" label="Key passphrase" help="Enter the key passphrase.">
                        <p-password id="passphrase" formControlName="passphrase" maxlength="80" gebo-ai-field-element />
                    </gebo-ai-field>
                </div>
                <div class="col-12">
                    <gebo-ai-field id="key" label="Secret key" help="Open the private key file and copy on this text area.">
                        <textarea rows="5" cols="120" pTextarea id="key" formControlName="key" gebo-ai-field-element>
                        </textarea>
                    </gebo-ai-field>
                </div>
                <div class="col-12">
                    <gebo-ai-field id="pub" label="Public key" help="Open the public key file and copy on this text area.">
                        <textarea rows="5" cols="120" pTextarea id="pub" formControlName="pub" gebo-ai-field-element>
                        </textarea>
                    </gebo-ai-field>
                </div>
            </div>

            <div class="col-12 " *ngIf="actualSecretType==='OAUTH2_STANDARD'">
                <gebo-ui-oauth2-secret-component
                    formControlName="oauth2StandardContent" [forcedProviderName]="oauth2ForcedProviderName" [oauth2ChoosableScopes]="oauth2ChoosableScopes" [oauth2MandatoryScopes]="oauth2MandatoryScopes" [hideProviderChoice]="hideProviderChoice">
                </gebo-ui-oauth2-secret-component>
            </div>
            <div class="col-12 grid" *ngIf="actualSecretType==='OAUTH2_GOOGLE'" formGroupName="googleOauth2Content">
                <!-- 
                <div class="col-12">
                    <div class="flex flex-column gap-2">
                        <label for="user">User</label>
                        <input pInputText id="uid" formControlName="uid" 
                            aria-describedby="uid-help" />
                        <small id="username-help">
                            Enter the user indicated by the token.
                        </small>
                    </div>
                </div> -->
                <div class="col-12">
                    <gebo-ai-field id="token" label="Token" help="Enter the token.">
                        <input pInputText id="token" formControlName="token" gebo-ai-field-element />
                    </gebo-ai-field>
                </div>
                <div class="col-12">
                    <gebo-ai-field id="projectId" label="projectId" help="Enter the project id.">
                        <input pInputText id="projectId" formControlName="projectId" gebo-ai-field-element />
                    </gebo-ai-field>
                </div>
                <div class="col-12">
                    <gebo-ai-field id="location" label="Location" help="Enter the location.">
                        <input pInputText id="location" formControlName="location" gebo-ai-field-element />
                    </gebo-ai-field>
                </div>
            </div>
            <div class="col-12" *ngIf="actualSecretType==='GOOGLE_CLOUD_JSON_CREDENTIALS'" formGroupName="googleJsonContent">
                <gebo-ai-field id="jsonContent" label="Google credentials file content" help="Copy here the file content of Google api credentials file downloaded from the google cloud api console (https://console.cloud.google.com/)">
                    <textarea pTextarea id="jsonContent" formControlName="jsonContent" rows="10" cols="80" gebo-ai-field-element>
                    </textarea>
                </gebo-ai-field>
            </div>
        </div>
        <div class="geboButtonsBar" style="vertical-align: baseline;" *ngIf="!isWizardMode">
            <div class="grid">
                <div class="col-4">
                    <p-button [outlined]="true" label="Insert" (onClick)="doSave()" icon="pi pi-save" severity="success" [disabled]="this.formGroup.invalid || canSave===false" styleClass="w-full"></p-button>
                </div>
                <div class="col-4">
                    <p-button [outlined]="true" label="Cancel" severity="contrast" (onClick)="cancelAction.emit(true)" styleClass="w-full" />
                </div>
                <div class="col-4">
                    <p-button [outlined]="true" label="Delete" severity="danger" icon="pi pi-trash" (onClick)="doDelete()" [disabled]="true" styleClass="w-full" />
                </div>
            </div>
        </div>
    </div>

</p-panel>
<!-- Treated By refactory robot GeboAIHtmlMultilanguageBot -->