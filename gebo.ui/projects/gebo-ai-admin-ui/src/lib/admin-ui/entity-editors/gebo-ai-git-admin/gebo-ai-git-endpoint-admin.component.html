<!--
/**
 * This Source Code is subject to the terms of the 
 * Gebo.ai community version Mozilla Public License Version 2.0 (MPL-2.0) â€” With Data Protection Clauses
 * If a copy of the LICENCE was not distributed with this file, You can obtain one at 
 * https://gebo.ai/gebo-ai-community-version-mozilla-public-license-version-2-0-mpl-2-0-with-data-protection-clauses/  
 * and https://mozilla.org/MPL/2.0/.
 * Copyright (c) 2025+ Gebo.ai 
 */
 -->
 
 
 

<p-blockUI [target]="endPointUI" [blocked]="loading">
  <i class="pi pi-lock" style="font-size: 3rem"></i>
</p-blockUI>
<p-panel id="MainPanel" gebo-ai-label  #endPointUI header="Editing git source/documentation repository" [formGroup]="formGroup">
  <div class="geboDialogContent">
    <p-messages [(value)]="userMessages" [enableService]="false" [closable]="false" />
    <p-tabView class="standardTabDialogueHeight">
      <p-tabPanel header="Settings">
        <div class="grid">

          <div class="col-6">
            <gebo-ai-field id="description" label="Description" help="Enter the description of the git repo." [required]="true">
              <input pInputText id="description" formControlName="description" maxlength="120" [required]="true" gebo-ai-field-element />
            </gebo-ai-field>
          </div>
          <div class="col-6">
            <gebo-ai-field id="code" label="Unique Code" help="Automatically generated unique code of the git repo.">
              <input pInputText id="code" formControlName="code" readonly="true" gebo-ai-field-element />
            </gebo-ai-field>
          </div>
          <div class="col-6">
            <gebo-ai-field id="parentProjectCode" label="Project" help="Parent project reference." [required]="true">
              <geboai-editable-listbox-component formControlName="parentProjectCode" placeholder="Select a project" [required]="true" [optionsObservable]="projectsObservable" [readonly]="cantModifyProject" gebo-ai-field-element>
              </geboai-editable-listbox-component>
            </gebo-ai-field>
          </div>
          <div class="col-6">
            <gebo-ai-field id="contentManagementSystem" label="Git system" help="Already configured git system reference." [required]="true">
              <geboai-editable-listbox-component formControlName="contentManagementSystem" [required]="true" [readonly]="mode!=='NEW'" placeholder="Select a git server setting" [optionsObservable]="gitSystemsObservable" [readonly]="cantModifyGitSystem" gebo-ai-field-element>
              </geboai-editable-listbox-component>
            </gebo-ai-field>
          </div>
          <div class="col-12">
            <gebo-ai-field id="repositoryUri" label="Repository url/address" help="Complete address of the git remote repository (usually starts with http: or https: or ssh:)" [required]="true">
              <input pInputText id="repositoryUri" formControlName="repositoryUri" (blur)="onGitConnectivityChange()" [required]="true" gebo-ai-field-element />
            </gebo-ai-field>
          </div>
          <div class="col-4">
            <gebo-ai-field id="branch" label="Branch" help="Branch name to checkout (normally master, main or develop)" [required]="true">
              <geboai-editable-listbox-component id="branch" formControlName="branch" [required]="true" placeholder="Select a branch" [optionsObservable]="branchesObservable" gebo-ai-field-element>
              </geboai-editable-listbox-component>
            </gebo-ai-field>
          </div>


          <div class="col-2">
            <gebo-ai-field id="publicAccess" label="public" help="If true the repository access does not require autentication">
              <p-checkbox formControlName="publicAccess" id="publicAccess" [binary]="true" [trueValue]="true"
                [falseValue]="false" (onBlur)="onGitConnectivityChange()" gebo-ai-field-element></p-checkbox>
            </gebo-ai-field>
          </div>
          <div class="col-4" >
            <gebo-ai-field id="identityCode" label="Identity used" help="Select the identity to do clone/checkout on the system" [required]="publicAccess===false">
              <geboai-editable-listbox-component formControlName="identityCode" id="identityCode"
                [required]="publicAccess===false" placeholder="Select an identity"
                [optionsObservable]="identitiesObservable" [createNewRecordRequest]="newSecretAction"
                (selectionChanged)="onGitConnectivityChange()" gebo-ai-field-element>
              </geboai-editable-listbox-component>
            </gebo-ai-field>
          </div>
          <div class="col-2">
            <gebo-ai-field id="openZips" label="Open zip files" help="Enable zip files opening and content extraction">
              <p-checkbox formControlName="openZips" id="openZips" [binary]="true" [trueValue]="true" [falseValue]="false" gebo-ai-field-element></p-checkbox>
            </gebo-ai-field>
          </div>
          <div class="col-12">
            <gebo-ai-field id="programmedTables" label="Contents updates checks schedule" help="Configure the scheduling of changed contents to mantain the retrieve augmented generation system updated">
              <gebo-ai-content-reindex-scheduler-component formControlName="programmedTables" id="programmedTables" gebo-ai-field-element></gebo-ai-content-reindex-scheduler-component>
            </gebo-ai-field>
          </div>
          <div class="col-10">
            <gebo-ai-field id="buildSystemsRefs" label="Configure build systems" help="List of build/packaging systems to inspect for meta informations and additional artifacts infos">
              <gebo-ai-build-systems-chooser id="buildSystemsRefs"
                formControlName="buildSystemsRefs" gebo-ai-field-element></gebo-ai-build-systems-chooser>
            </gebo-ai-field>
          </div>

        </div>

      </p-tabPanel>
      <p-tabPanel header="Logs" [disabled]="!objectReference">
        <gebo-ai-log-table-component [jobType]="'CONTENTS_READING_VECTORIZING'" [endPointReference]="objectReference"
          title="This git repository ingestion log"></gebo-ai-log-table-component>
      </p-tabPanel>
    </p-tabView>
  </div>


  <div class="geboLargeButtonsBar" style="vertical-align: baseline;" *ngIf="!isWizardMode">
    <div class="grid">
      <div class="col-3">
        <p-button [outlined]="true" label="Save" (onClick)="doSave()" icon="pi pi-save" severity="success"
          styleClass="w-full"
          [disabled]="this.formGroup.invalid || canSave===false || relatedBackendProcessingRunning===true"></p-button>
      </div>
      <div class="col-3">
        <p-button [outlined]="true" label="Publish!"
          title="Save and let these contents being available in knowledge base to LLm's" severity="success"
          styleClass="w-full" icon="pi pi-microchip-ai" (onClick)="doPublish()"
          [disabled]="this.formGroup.invalid || canSave===false || relatedBackendProcessingRunning===true" />

      </div>
      <div class="col-3">
        <p-button [outlined]="true" label="Cancel" severity="contrast" (onClick)="cancelAction.emit(true)"
          styleClass="w-full" />
      </div>
      <div class="col-3">
        <p-button [outlined]="true" label="Delete" severity="danger" icon="pi pi-trash" (onClick)="doDelete()"
          styleClass="w-full" [disabled]="canDelete===false || relatedBackendProcessingRunning===true" />
      </div>

    </div>
  </div>
</p-panel>
<!-- Treated By refactory robot GeboAIHtmlMultilanguageBot -->