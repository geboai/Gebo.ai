$
<!--
/**
 * This Source Code is subject to the terms of the 
 * Gebo.ai community version Mozilla Public License Version 2.0 (MPL-2.0) â€” With Data Protection Clauses
 * If a copy of the LICENCE was not distributed with this file, You can obtain one at 
 * https://gebo.ai/gebo-ai-community-version-mozilla-public-license-version-2-0-mpl-2-0-with-data-protection-clauses/  
 * and https://mozilla.org/MPL/2.0/.
 * Copyright (c) 2025+ Gebo.ai 
 */
 -->

<p-blockUI id="BlockUI" gebo-ai-label [target]="endPointUI" [blocked]="loading">
  <i class="pi pi-lock" style="font-size: 3rem"></i>
</p-blockUI>
<p-panel id="MainPanel" gebo-ai-label  #endPointUI header="Editing uploaded content" [formGroup]="formGroup">
  <div class="geboDialogContent">
    <p-messages id="Messages" gebo-ai-label [(value)]="userMessages" [enableService]="false" [closable]="false" />
    <p-toast id="Toast" gebo-ai-label />
    <p-tabView id="TabView" gebo-ai-label class="standardTabDialogueHeight">
      <p-tabPanel id="SettingsTab" gebo-ai-label header="Settings">
        <div class="grid">
          <div class="col-6">
            <gebo-ai-field id="description" label="Description" help="Enter the description of the uploaded content of filesystem entry." [required]="true">
              <input 
                pInputText
                id="description"
                formControlName="description"
                maxlength="120"
                [required]="true"
                gebo-ai-field-element
              />
            </gebo-ai-field>
          </div>
          <div class="col-6">
            <gebo-ai-field id="code" label="Unique Code" help="Automatically generated unique code of the contents.">
              <input 
                pInputText
                id="code"
                formControlName="code"
                readonly="true"
                gebo-ai-field-element
              />
            </gebo-ai-field>
          </div>
          <div class="col-6">
            <gebo-ai-field id="parentProjectCode" label="Project" help="Parent project reference." [required]="true">
              <geboai-editable-listbox-component 
                formControlName="parentProjectCode"
                placeholder="Select a project"
                [required]="true"
                [optionsObservable]="projectsObservable"
                [readonly]="cantModifyProject"
                gebo-ai-field-element
              >
              </geboai-editable-listbox-component>
            </gebo-ai-field>
          </div>
          <div class="col-6">
            <gebo-ai-field id="openZips" label="Open zip files" help="Enable zip files opening and content extraction">
              <p-checkbox 
                formControlName="openZips"
                id="openZips"
                [binary]="true"
                [trueValue]="true"
                [falseValue]="false"
                gebo-ai-field-element
              ></p-checkbox>
            </gebo-ai-field>
          </div>

          <div class="col-12">
            <gebo-ai-field id="upload" label="Upload contents" help="Click the browse button and select zip files or other files">
              <p-fileUpload 
                mode="basic"
                name="files[]"
                chooseIcon="pi pi-upload"
                *ngIf="!entity?.uploadedContents?.length"
                [disabled]="formGroup.invalid || !handShakeCode"
                [url]="baseUrl+'/api/admin/FileUploadController/upload/'+handShakeCode"
                [accept]="filesExtensionsFlatList"
                maxFileSize="100000000"
                [multiple]="true"
                method="post"
                (onBeforeUpload)="onBeforeUpload($event)"
                (onProgress)="onProgress($event)"
                (onUpload)="onBasicUploadAuto($event)"
                [auto]="true"
                chooseLabel="Browse"
                id="upload"
                gebo-ai-field-element
              ></p-fileUpload>
              <div id="upload" *ngIf="entity?.uploadedContents?.length">
                <span *ngFor="let u of entity?.uploadedContents">{{u}}</span><span>&nbsp;</span>
              </div>
            </gebo-ai-field>
          </div>

          <div class="col-12">
            <gebo-ai-field id="buildSystemsRefs" label="Configure build systems" help="List of build/packaging systems to inspect for meta informations and additional artifacts infos (leave empty if no software code is contained)">
              <gebo-ai-build-systems-chooser 
                id="buildSystemsRefs"
                formControlName="buildSystemsRefs"
                gebo-ai-field-element
              ></gebo-ai-build-systems-chooser>
            </gebo-ai-field>
          </div>

        </div>
      </p-tabPanel><p-tabPanel id="LogsTab" gebo-ai-label header="Logs" [disabled]="!objectReference">
        <gebo-ai-log-table-component [jobType]="'CONTENTS_READING_VECTORIZING'" [endPointReference]="objectReference"
          title="This upload files ingestion log"></gebo-ai-log-table-component>
      </p-tabPanel></p-tabView>
  </div>

  <div class="geboLargeButtonsBar" style="vertical-align: baseline;" *ngIf="!isWizardMode">
    <div class="grid">
      <div class="col-3">
        <p-button id="SaveBtn" gebo-ai-label [outlined]="true" label="Save" (onClick)="doSave()" icon="pi pi-save" severity="success"
          [disabled]="this.formGroup.invalid || canSave===false || relatedBackendProcessingRunning===true"
          styleClass="w-full"></p-button>
      </div>
      <div class="col-3">
        <p-button id="PublishBtn" gebo-ai-label [outlined]="true" label="Publish!"
          title="Saves and let these contents being available in knowledge base to LLm's" severity="success"
          icon="pi pi-microchip-ai" (onClick)="doPublish()"
          [disabled]="this.formGroup.invalid || canSave===false || relatedBackendProcessingRunning===true"
          styleClass="w-full" />

      </div>
      <div class="col-3">
        <p-button id="CancelBtn" gebo-ai-label [outlined]="true" label="Cancel" severity="contrast" (onClick)="cancelAction.emit(true)"
          styleClass="w-full" />
      </div>
      <div class="col-3">
        <p-button id="DeleteBtn" gebo-ai-label [outlined]="true" label="Delete" severity="danger" icon="pi pi-trash" (onClick)="doDelete()"
          styleClass="w-full" />
      </div>

    </div>
  </div>
</p-panel>

<!-- Treated By refactory robot GeboAIHtmlMultilanguageBot -->
<!-- Treated By refactory robot ROBOT-REFACTORY-PRIMENG-COMPONENTS-HTML-NODES-GEBOAI -->