<p-blockUI id="BlockUIButton" [target]="modelTypePanel" [blocked]="loading">
    <i class="pi pi-lock" style="font-size: 3rem"></i>
</p-blockUI>
<p-panel #modelTypePanel id="ModelTypePanel" header="Add new models" gebo-ai-label>
    <br />
    <p-fieldset id="ModelTypeFieldSet" gebo-ai-label legend="Provider credentials" [formGroup]="secretFormGroup">
        <div class="grid">
            <div class="col-3" *ngIf="existingOrNewShow">
                <gebo-ai-field id="UseExistingOrNewCredentials" label="Use existing or new"
                    help="Use existing or create new credentials for this provider">
                    <p-selectbutton [options]="useExistingOrNewOptions" optionLabel="label" optionValue="value"
                        formControlName="useExistingOrNew" />
                </gebo-ai-field>
            </div>
            <div class="col-9" *ngIf="secretFormGroup.controls['useExistingOrNew'].value==='EXISTING'">
                <gebo-ai-field id="ExistingApiKey" label="Api key/credentials"
                    help="Choose api key or credentials for this provider">
                    <geboai-editable-listbox-component formControlName="selectedSecret" [data]="secrets"
                        gebo-ai-field-element></geboai-editable-listbox-component>
                </gebo-ai-field>
            </div>
            <div class="col-9 grid" *ngIf="secretFormGroup.controls['useExistingOrNew'].value==='NEW'">
                <div class="col-3">
                    <gebo-ai-field id="NewUserName" label="User name" help="User name used to access provider services"
                        [required]="secretFormGroup.controls['useExistingOrNew'].value==='NEW'">
                        <input pInputText type="text" gebo-ai-field-element formControlName="newUserName">
                    </gebo-ai-field>
                </div>
                <div class="col-8">
                    <gebo-ai-field id="NewApiKey" label="New api key"
                        help="Insert a new api key to be used with this provider"
                        [required]="secretFormGroup.controls['useExistingOrNew'].value==='NEW'">
                        <input pInputText type="text" gebo-ai-field-element formControlName="newApiSecret">
                    </gebo-ai-field>
                </div>
                <div class="col-1" style="vertical-align: middle;">
                    <gebo-ai-field id="PiSave" label="Save" help="">
                        <p-button icon="pi pi-save" [outlined]="true" gebo-ai-field-element
                            [disabled]="secretFormGroup.invalid" (onClick)="createCredentials()"></p-button>
                    </gebo-ai-field>
                </div>
            </div>
            <div class="col-12" *ngIf="vendorConfiguration?.parentModel?.requiresCustomUrl===true">
                <gebo-ai-field id="baseUrl" label="Base api url" help="Base url for the api services of the provider"
                    [required]="vendorConfiguration?.parentModel?.requiresCustomUrl===true">
                    <input pInputText type="text" gebo-ai-field-element formControlName="baseUrl">
                </gebo-ai-field>
            </div>
        </div>
    </p-fieldset>
    <p-fieldset id="ModelsChoices" legend="Models choices" gebo-ai-label
        *ngIf="chatPresets.length>0 || embeddingPresets.length>0 || lookedUpEmbeddingModels.length>0 || lookedUpChatModels.length>0">
        <p-tabView class="geboFullHeight">

            <p-tabPanel id="PresetsAccordionPanel" gebo-ai-label header="Suggested models selection" *ngIf="chatPresets.length>0 || embeddingPresets.length>0">
                <div class="grid">
                        <div class="col-12">
                            <p id="PresedAccordionDesc" gebo-ai-text>
                                We suggest you the following models list
                            </p>
                        </div>
                        <div class="col-6" *ngIf="chatPresets.length>0" [formGroup]="chatModelPresetsFormGroup">
                            <gebo-ai-field id="chatPresetChoice" label="Chat model"
                                help="Select one of the predefined chat models">
                                <geboai-editable-listbox-component formControlName="choosedModel" [data]="chatPresets"
                                    gebo-ai-field-element></geboai-editable-listbox-component>
                            </gebo-ai-field>
                        </div>
                        <div class="col-6" *ngIf="chatPresets.length>0">

                        </div>
                        <div class="col-6" *ngIf="embeddingPresets.length>0"
                            [formGroup]="embeddingModelPresetsFormGroup">
                            <gebo-ai-field id="embeddingPresetChoice" label="Embedding model"
                                help="Select one of the predefined embedding models">
                                <geboai-editable-listbox-component formControlName="choosedModel"
                                    [data]="embeddingPresets" gebo-ai-field-element></geboai-editable-listbox-component>
                            </gebo-ai-field>
                        </div>
                        <div class="col-6" *ngIf="embeddingPresets.length>0">

                        </div>
                    </div>
            </p-tabPanel>
            <p-tabPanel id="AdvancedAccordionPanel" gebo-ai-label header="Advanced models selection" *ngIf="lookedUpEmbeddingModels.length>0 || lookedUpChatModels.length>0">
                <div class="grid">
                        <div class="col-12"><p id="PresedAccordionDesc" gebo-ai-text>
                                Use this selection mode only if you are expert or by checking on the supplier site wich models fit your needs.
                            </p></div>
                        <div class="col-6" *ngIf="lookedUpChatModels.length>0" [formGroup]="chatModelAdvancedFormGroup">
                            <gebo-ai-field id="chatAdvancedChoice" label="Chat model"
                                help="Select one of the supplier published chat models">
                                <geboai-editable-listbox-component formControlName="choosedModel"
                                    [data]="lookedUpChatModels"
                                    gebo-ai-field-element></geboai-editable-listbox-component>
                            </gebo-ai-field>
                        </div>
                        <div class="col-6" *ngIf="chatPresets.length>0">

                        </div>
                        <div class="col-6" *ngIf="lookedUpEmbeddingModels.length>0"
                            [formGroup]="embeddingModelAdvancedFormGroup">
                            <gebo-ai-field id="embeddingAdvancedChoice" label="Embedding model"
                                help="Select one of the  supplier published  embedding models">
                                <geboai-editable-listbox-component formControlName="choosedModel"
                                    [data]="lookedUpEmbeddingModels"
                                    gebo-ai-field-element></geboai-editable-listbox-component>
                            </gebo-ai-field>
                        </div>
                        <div class="col-6" *ngIf="embeddingPresets.length>0">

                        </div>
                    </div>
            </p-tabPanel></p-tabView>
        
    </p-fieldset>
</p-panel>