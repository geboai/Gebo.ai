<!--
/**
 * This Source Code is subject to the terms of the 
 * Gebo.ai community version Mozilla Public License Version 2.0 (MPL-2.0) â€” With Data Protection Clauses
 * If a copy of the LICENCE was not distributed with this file, You can obtain one at 
 * https://gebo.ai/gebo-ai-community-version-mozilla-public-license-version-2-0-mpl-2-0-with-data-protection-clauses/  
 * and https://mozilla.org/MPL/2.0/.
 * Copyright (c) 2025+ Gebo.ai 
 */
 -->
 
 
 

<p-dialog  [maximizable]="true" [visible]="openEditWindow" [modal]="true" [style]="{width:'95%',height:'800px'}" [closable]="true"
    header="Choose elements" [showHeader]="true" (onHide)="this.openEditWindow=false;"
    (visibleChange)="this.openEditWindow=false;">
    <p-panel #window [showHeader]="false">
        <p-blockUI [target]="window" [blocked]="loading">
            <i class="pi pi-lock" style="font-size: 3rem"></i>
        </p-blockUI>
        <p-messages [value]="messages" enableService="false" />

        <div class="grid" style="width:240px;">
            <div class="col-6">
                <p-button label="OK" [outlined]="true" icon="pi pi-check" (onClick)="confirmEditing()"
                    severity="success"></p-button>
            </div>
            <div class="col-6">
                <p-button label="Cancel" [outlined]="true" icon="pi pi-cancel" (onClick)="openEditWindow=false;"
                    severity="secondary"></p-button>
            </div>
        </div>
        <p-fieldset legend="Choosed elements">
            <div style="width: 100%; border: solid #C0C0C0 1px;">

                <p-chip *ngFor="let p of editingNodeValues;" [label]="(p.path?''+p.path.name:p.root.description)"
                    [removable]="true" (onRemove)="removeFromEditPanel(p)"
                    [icon]="'pi ' + ((!p.path || p.path.folder===true)?'pi-folder':'pi-file' )" />

            </div>
        </p-fieldset>
        <p-fieldset legend="Choose elements">
            <p-tree class="md:w-20rem w-full col-12" [value]="roots" (onNodeExpand)="nodeExpand($event)"
            (onNodeCollapse)="nodeCollapse($event)" (onNodeSelect)="nodeSelect($event)"
            (onNodeUnselect)="nodeUnselect($event)" [selectionMode]="selectionMode"
            containerStyleClass="w-full col-12" [filter]="true">
            <ng-template let-node pTemplate="default">
                <div [formGroup]="formGroup" [style]="onlineStyle(node)">
                    <p-checkbox name="choosed" id="choosed" *ngIf="showCheckbox(node)" formControlName="choosed"
                        [value]="node.data.uniqueCode"></p-checkbox>
                    <p-radioButton name="choosed" id="choosed" *ngIf="showRadio(node)" formControlName="choosed"
                        [value]="node.data.uniqueCode"></p-radioButton>
                    {{node.label}}
                </div>
            </ng-template>
        </p-tree>
        </p-fieldset>
        
    </p-panel>
</p-dialog>

<div style="width: 100%; border: solid #C0C0C0 1px;">
    <p-button [disabled]="readonly" (onClick)="openEditMode()" icon="pi pi-pen-to-square" title="Modify selected"
        [outlined]="true"></p-button>
    <p-chip *ngFor="let p of internalValue;" [label]="(p.path?''+p.path.name:p.root.description)"
        [removable]="readonly===false" (onRemove)="removeFromMainPanel(p)"
        [icon]="'pi ' + ((!p.path || p.path.folder===true)?'pi-folder':'pi-file' )" />

</div>