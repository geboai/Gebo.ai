<!--
/**
 * This Source Code is subject to the terms of the 
 * Gebo.ai community version Mozilla Public License Version 2.0 (MPL-2.0) â€” With Data Protection Clauses
 * If a copy of the LICENCE was not distributed with this file, You can obtain one at 
 * https://gebo.ai/gebo-ai-community-version-mozilla-public-license-version-2-0-mpl-2-0-with-data-protection-clauses/  
 * and https://mozilla.org/MPL/2.0/.
 * Copyright (c) 2025+ Gebo.ai 
 */
 -->
 
 
 

<p-panel #UsBrowse header="Knowledge bases & user files">
    <p-blockUI [target]="UsBrowse" [blocked]="loading">
        <i class="pi pi-lock" style="font-size: 3rem"></i>
    </p-blockUI>
    <div class="grid" style="width:240px;">
        <div class="col-6">
            <p-button label="OK" [outlined]="true" icon="pi pi-check" (onClick)="confirmEditing()" severity="success"
                [disabled]="formGroup.invalid"></p-button>
        </div>
        <div class="col-6">
            <p-button label="Cancel" [outlined]="true" icon="pi pi-cancel" (onClick)="closeMe.emit(false)"
                severity="secondary"></p-button>
        </div>
    </div>
    <p-fieldset legend="Choosed elements">
        <div style="width: 100%; border: solid #C0C0C0 1px;">

            <p-chip *ngFor="let p of choosedDisplay;" [label]="p.name" [removable]="true" (onRemove)="removeChip(p)"
                icon="pi pi-file" />

        </div>
    </p-fieldset>
    <p-fieldset legend="Choose user uploaded content">
        <p-tree [value]="root" (onNodeExpand)="nodeExpand($event)">
            <ng-template let-node pTemplate="default">
                <span [formGroup]="formGroup">

                    <p-checkbox name="choosed" id="choosed" *ngIf="node.data?.isFile===true && node.data?.data?.code"
                        formControlName="choosed" [value]="node.data.data.code"></p-checkbox>
                    <label for="choosed" class="ml-2"> {{node.data.data.name}} </label>



                    <p-button *ngIf="node.data.isKnowledgeBase===true || node.data.isUserspaceFolder===true"
                        [label]="node.label" icon="pi pi-replay" (onClick)="refreshThis(node,$event)"
                        [text]="true"></p-button>
                    <p-button *ngIf="node.data?.isFile===true && (node.data?.data?.code?false:true)"
                        [label]="node.label" icon="pi pi-clock" title="This file is not yet processed or published"
                        [text]="true" (onClick)="refreshThis(node.parent,$event)"></p-button>
                    <p-button label="Add your space here" [text]="true" *ngIf="node.data.isKnowledgeBase===true"
                        (onClick)="newChildKnowledgebase(node)"></p-button>
                    <p-button [text]="true" *ngIf="node.data.isUserKnowledgeBase===true"
                        (onClick)="editChildKnowledgebase(node)"></p-button>
                    <p-button label="Add folder" [text]="true" *ngIf="node.data.isUserKnowledgeBase===true"
                        (onClick)="newChildFolder(node)"></p-button>
                    <p-button label="Edit folder" [text]="true" *ngIf="node.data.isUserspaceFolder===true"
                        (onClick)="openFolder(node)"></p-button>
                </span>
            </ng-template>
        </p-tree>
    </p-fieldset>
</p-panel>